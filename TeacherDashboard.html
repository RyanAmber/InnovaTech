<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="teacher.css">
  <style rel="stylesheet" href="teacher.css">

  </style>

</head>
  
<body>
  <header id="usernameHeader">Welcome, </header>
  
  <div class="container">
    <div class="left">
      <div class="bubble-heading">Component List</div>
      <div class="grid">
        <div class="card" onclick="openModal('Arduino', 'A microcontroller board.', 'https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg')">
          <img src="https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg" alt="Arduino">
          <p>Arduino</p>
        </div>
        <div class="card" onclick="openModal('Capacitor', 'Description.', 'https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg')">
          <img src="https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg" alt="Capacitor">
          <p>Capacitor</p>
        </div>
        <div class="card" onclick="openModal('LED', 'Description.', 'https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg')">
          <img src="https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg" alt="LED">
          <p>LED</p>
        </div>
        <div class="card" onclick="openModal('Transistor', 'Description.', 'https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg')">
          <img src="https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg" alt="Transistor">
          <p>Transistor</p>
        </div>
        <div class="card" onclick="openModal('Raspberry Pi', 'Description.', 'https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg')">
          <img src="https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg" alt="Raspberry Pi">
          <p>Raspberry Pi</p>
        </div>
        <div class="card" onclick="openModal('Breadboard', 'Description.', 'https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg')">
          <img src="https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg" alt="Breadboard">
          <p>Breadboard</p>
        </div>
        <div class="card" onclick="openModal('Push Button', 'Description.', 'https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg')">
          <img src="https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg" alt="Push Button">
          <p>Push Button</p>
        </div>
        <div class="card" onclick="openModal('Potentiometer', 'Description.', 'https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg')">
          <img src="https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg" alt="Potentiometer">
          <p>Potentiometer</p>
        </div>
        <div class="card" onclick="openModal('Diode', 'Description.', 'https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg')">
          <img src="https://upload.wikimedia.org/wikipedia/commons/3/38/Arduino_Uno_-_R3.jpg" alt="Diode">
          <p>Diode</p>
        </div>
      </div>
    </div>
    
    <div class="right">
      <div class="admin-nav">
        <div class="bubble-heading">Navigation</div>
        <!--<button>Manage Classroom</button>-->
        <a href="ManageClass.html"><button type="button">Manage Classroom</button></a>
        <button>Add New Component</button>
        <button>Remove Component</button>
      </div>

      <div class="notifications-wrapper">
        <div class="bubble-heading">Notifications</div>
        <div class="notifications">
          <div class="notif">
            <div class="notif-time">10<br>min</div>
            <div class="notif-text"><strong>Join Request</strong><br>'191966' requested to join classroom.</div>
          </div>
          <div class="notif">
            <div class="notif-time">1<br>D</div>
            <div class="notif-text"><strong>Quantity Alert</strong><br>‘Arduino Uno’ at only 10% availability.</div>
          </div>
          <div class="notif">
            <div class="notif-time">35<br>min</div>
            <div class="notif-text"><strong>Join Request</strong><br>‘123456’ requested to join classroom.</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="modal" id="modal">
    <div class="modal-content">
      <span class="close-btn" onclick="closeModal()">&times;</span>
  
      <!-- LEFT SIDE: text content -->
      <div class="modal-left">
        <h2 id="modalTitle" class="component-name">Component_Name</h2>
  
        <h3>Component Overview</h3>
        <div class="overview-box">
          <p>Number logged in: <span id="totalCount">X</span></p>
          <p>Number in use: <span id="AvailableCount">X</span></p>
          <p>Your component: <span id="userStatus">X</span></p>
        </div>
  
        <h3>Actions</h3>
        <div class="actions">
          <button class="action-btn">Check out Component</button>
          <button class="action-btn">Mark as damaged or broken</button>
          <button class="action-btn">Return Component</button>
        </div>
      </div>
  
      <!-- RIGHT SIDE: image and bar -->
      <div class="modal-right">
        <img id="modalImage" class="component-img" src="" alt="Component Image">
        <div class="status-bar">
          <div class="status green" style="width: 60%">60%</div>
          <div class="status red" style="width: 15%">15%</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const username = localStorage.getItem("username") || "Student";
    if (username==="Student"){
      window.location.href = 'index.html';
    }
    document.getElementById("usernameHeader").textContent = `Welcome, ${username}`;
    document.title = `${username}'s Dashboard`;
    
    function openModal(name, description, imageUrl) {
  const total = countMap.get(name) || 0;
  const working = workingMap.get(name) || 0;

  document.getElementById('modal').style.display = 'flex';
  document.getElementById('modalTitle').textContent = name;
  document.getElementById('modalImage').src = imageUrl;
  document.getElementById('totalCount').textContent = total;
  document.getElementById('AvailableCount').textContent = total - working;
  document.getElementById('userStatus').textContent = '✔';

  const greenPercent = total > 0 ? Math.round((working / total) * 100) : 0;
  const redPercent = total > 0 ? Math.round(((total - working) / total) * 100) : 0;

  const statusBar = document.querySelector('.status-bar');
  if(greenPercent+redPercent==0){
    statusBar.innerHTML = `
    <div class="status yellow" style="width: 100%">100%</div>
  `;
  }else{
  statusBar.innerHTML = `
    <div class="status green" style="width: ${greenPercent}%">${greenPercent}%</div>
    <div class="status red" style="width: ${redPercent}%">${redPercent > 0 ? redPercent + '%' : ''}</div>
  `;
  }
}



    function closeModal() {
      document.getElementById('modal').style.display = 'none';
    }
    const workingMap=new Map();
    const countMap = new Map();
  fetch('https://raw.githubusercontent.com/RyanAmber/InnovaTech/refs/heads/main/InventoryData.txt')
  .then(response => response.text())
  .then(text => {
    const lines = text.split('\n');
    for (const line of lines) {
      const [type,working,team,ID] = line.trim().split(',');
      countMap.set(type, (countMap.get(type) || 0) + 1);
      if (working == 'True'&&team=='0') {
        workingMap.set(type, (workingMap.get(type) || 0) + 1);
      }
    }
    console.log(countMap);
    console.log(workingMap);
  })
  .catch(error => console.error('Error loading file:', error));

    window.onclick = function(e) {
      const modal = document.getElementById('modal');
      if (e.target === modal) closeModal();
    }
  </script>
</body>
</html>
