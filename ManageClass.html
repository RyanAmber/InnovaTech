<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Manage Classroom</title>
  <link rel="stylesheet" href="Management.css">

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore-compat.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDq7FI-N984HO2M7Q0l25WEoiTBqZvZfHs",
      authDomain: "innovatech-86917.firebaseapp.com",
      projectId: "innovatech-86917",
      storageBucket: "innovatech-86917.appspot.com",
      messagingSenderId: "222788972248",
      appId: "1:222788972248:web:d0d5b8968f24b9c00671ad",
      measurementId: "G-GTX1QPXJ2R"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>
</head>
<body>
  <div class="container">
    <h1>Manage Classroom</h1>

    <!-- TABS -->
    <div class="tabs">
      <button class="tab active">Overview</button>
      <button class="tab">Teams</button>
      <button class="tab">Flagged</button>
    </div>

    <div class="main-content">

      <!-- LEFT COLUMN -->
      <div class="section">
        <h2>For approval</h2>
        <ul class="approval-list">
          <li><span class="dot green"></span> 191966</li>
          <li><span class="dot red"></span> spammmm</li>
          <li><span class="dot green"></span> 192832</li>
        </ul>

        <h3>Current List</h3>
        <ul class="current-list" id="current-list">
          <!-- User IDs will be appended here -->
        </ul>
      </div>

      <!-- MIDDLE COLUMN -->
      <div class="section teams">
        <p class="instruction">Groups and members from Firebase:</p>
        <div class="id-boxes" id="id-boxes">
          <!-- Group boxes will be appended here -->
        </div>
      </div>

      <!-- RIGHT COLUMN -->
      <div class="section flagged">
        <p>(Placeholder for flagged users)</p>
      </div>

    </div>
  </div>

  <script>
    async function loadGroupsFromFirebase() {
      const groupContainer = document.getElementById("id-boxes");

      try {
        const groupsSnapshot = await db.collection("Groups").get();

        for (const groupDoc of groupsSnapshot.docs) {
          const groupName = groupDoc.id;
          const usersRef = db.collection("Groups").doc(groupName).collection("Users");
          const usersSnapshot = await usersRef.get();

          const userList = [];
          usersSnapshot.forEach(userDoc => {
            userList.push(userDoc.id);
          });

          const box = document.createElement("div");
          box.className = "id-box";
          box.innerHTML = `<strong>${groupName}</strong><br>${userList.join("<br>") || "<em>No users</em>"}`;
          groupContainer.appendChild(box);
        }
      } catch (error) {
        console.error("Error loading groups from Firebase:", error);
      }
    }

    // Start loading on page load
    window.onload = () => {
      loadGroupsFromFirebase();
    };
  </script>
</body>
</html>
